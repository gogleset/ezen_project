<!-- 
@Filename: admin event-add.html
@Author: 임다정 (dazoo0221@gmail.com)
@description: admin event-add HTML
 -->

 <!DOCTYPE html>
 <html lang="en">
 
 <head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Document</title>
     <!-- bootstrap -->
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
 
     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
 
     <!-- Optional theme -->
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css">
     <link rel="stylesheet" href="../../css/admin/layout.css">
     <link rel="stylesheet" href="../../css/admin/event-add.css">
 </head>
 
 <body>
     <!-- 헤더입니다. -->
     <div data-init="../inc/admin-header.html"></div>
     <!-- 서브 타이틀 영역입니다. -->
     <div class="container">
         <div class="content-header">
             <h3 class="content-title pull-left">이벤트</h3>
             <span class="content-sub-title pull-right">홈-이벤트-이벤트 등록/수정</span>
         </div>
     </div>
 
     <!-- 데이터 테이블 영역입니다. -->
     <form class="container table-container" id="event-form">
         <table class="table table-bordered table-hover table-condensed table-striped">
             <colgroup>
                 <col width="20%">
                 <col width="80%">
             </colgroup>
             <thead>
                 <tr>
                     <th>제목</th>
                     <td><input type="text" class="form-control" id="title" name="title" placeholder="내용을 입력해주세요" /></td>
                 </tr>
             </thead>
             <tbody>
                 <tr>
                     <th>Link</th>
                     <td><input type="text" class="form-control" id="link" name="link" placeholder="내용을 입력해주세요" /></td>
                 </tr>
                 <tr>
                     <th rowspan="2">사진</th>
                     <form enctype="multipart/form-data" action="uploadImage.json" method="post"></form>
                     <td><input type="file" name="img" accept="image/*" id="img" onchange="setThumbnail(event);"></td>
                 </tr>
                 <tr>
                     <td class="thumb-box">
                         <div class="thumb-img-box"></div>
                     </td>
                 </tr>
                 <tr>
                     <th>shows</th>
                     <td>
                         <div class="dropdown">
                             <div id="select" style="width: 200px; "></div>
                             <!-- <select name="event_show" id="event_show" class="form-control">
                             </select> -->
                         </div>
                     </td>
                 </tr>
             </tbody>
         </table>
 
         <!-- 저장 취소를 감싸는 영역입니다. -->
         <!--     <form class="container"> -->
         <div class="setting-container">
             <div class="flx">
                 <button class="btn btn-primary btn-admin-setting" id="submit" type="submit">저장</button>
                 <button class="btn btn-primary btn-admin-setting" id="cancel" type="button">취소</button>
             </div>
         </div>
         <!--     </form> -->
     </form>
 
     <script src="https://code.jquery.com/jquery-1.12.4.min.js"
         integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ"
         crossorigin="anonymous"></script>
     <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
     <script src="../assets/layout.js"></script>
     <script>
         // 게시 여부 옵션 만들어주기
         const target = document.querySelector('#select');
 
         const element = document.createElement('select');
         element.classList.add('form-control');
         element.innerHTML = ` <option value="">---선택하세요---</option>
                             <option value="Y" class="show">show</option>
                             <option value="N" class="show">disable</option>`
         target.appendChild(element);
 
     </script>
     <script>
         // 썸네일 보여주기
         function setThumbnail(event) {
             let reader = new FileReader();
             reader.onload = function (event) {
                 let img = document.createElement('img');
                 img.setAttribute('src', event.target.result);
                 document.querySelector('div.thumb-img-box').appendChild(img);
             };
 
             reader.readAsDataURL(event.target.files[0]);
         }
     </script>
     <script>
         document.querySelector('#event-form').addEventListener('submit', async (e) => {
             e.preventDefault();
 
             const eventTitle = document.querySelector('#title').value;
             const eventLink = document.querySelector('#link').value;
             const eventImg = document.querySelector('#img').value;
             const eventShow = document.querySelector('.show').value;
 
 
             let json = null;
 
             try {
                 const response = await axios.post('/event',{
                     event_title: eventTitle,
                     event_link: eventLink,
                     event_img: eventImg,
                     event_show: eventShow
                 })
                 json = response.data;
 
             } catch (e) {
                 alert(e.response.data.rtmsg);
                 return;
             };
 
             window.location = "/html/admin/event.html"
         });
     </script>
 
 </body>
 
 </html>